<section class="pqriValidation">
     <% if !@current_execution.validation_errors.try(:empty?) || !@current_execution.baseline_validation_errors.try(:empty?) %>
       <h2 class="fail">PQRI Validation Errors</h2>
       <h3>Cypress uses Northwestern Medical's XSD interpretation of
         <a href="/Registry_Payment.xsd" target="_blank">PQRI XML 2009</a>.
         This is NOT a CMS published XSD.
       </h3>

       <table class="table">
         
         <%= render partial: "pqri_errors", locals: {pqri_errors:@current_execution.validation_errors,title:"View PQRI Errors", data_code:"pqri_results" }%>
         <%= render partial: "pqri_errors", locals: {pqri_errors:@current_execution.baseline_validation_errors,title:"View Baseline PQRI Errors", data_code:"baselinepqri_results" }%>
        
     </table>
      <% end %>
   </section>

   <section id="quality_measures">
     <table class="table">
       <% @measures.each do |result_status, result_measures|
         next if result_measures.empty?
         if result_status == 'incomplete'
           title = 'Incomplete'
         else
           title = "#{result_status}ing"
         end %>

         <thead class="<%= result_status %>">
           <tr>
             <th colspan="2"><span class="<%= result_status %>"><%= title %></span> Measures</th>
             <th>Denominator</th>
             <th>Numerator</th>
             <th>Exclusions</th>
           </tr>
         </thead>
         <tbody class="<%= result_status %>">
           <%
             result_measures.each do |measure|
             expected_result = @current_execution.expected_result(measure)
             reported_result = @current_execution.reported_result(measure.key)
             result_status = 'incomplete' if reported_result['numerator'].class == String %>

             <tr id='<%= "#{measure.id}" %>'>
               <td class="<%= result_status %>-icon"><div title="<%= result_status %>" class="<%= result_status %>-icon"></div></td>
               <td title="<%= "#{@product.measure_map[measure.key]} " %>">
                 <a href="<%= product_test_measure_path(@test, measure, :execution => @current_execution) %>">
                   <%= "#{measure.key} " %>
                   <%= measure.name %>
                   <%= " - #{measure.subtitle}" if measure.sub_id %>
                 </a>
               </td>
               <% ['denominator', 'numerator', 'exclusions'].each do |bucket|
                 reported_class = result_class(reported_result[bucket], expected_result[bucket])
                 expected_class = bucket.slice(0,3) %>
                 <td><span class="<%= reported_class %>"><%= reported_result[bucket]%></span> / <span class="q <%= expected_class %>"><%= expected_result[bucket] %></span></td>
               <% end %>
             </tr>
           <% end %>
         </tbody>
       <% end %>
     </table>
   </section>